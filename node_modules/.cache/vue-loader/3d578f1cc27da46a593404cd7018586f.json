{"remainingRequest":"E:\\HBuilderX\\save\\save\\pc_bg_f\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HBuilderX\\save\\save\\pc_bg_f\\src\\views\\Home\\Chat\\Chat.vue?vue&type=style&index=0&id=1a65b88e&lang=less&scoped=true&","dependencies":[{"path":"E:\\HBuilderX\\save\\save\\pc_bg_f\\src\\views\\Home\\Chat\\Chat.vue","mtime":1595491475667},{"path":"E:\\HBuilderX\\save\\save\\pc_bg_f\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500371},{"path":"E:\\HBuilderX\\save\\save\\pc_bg_f\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500371},{"path":"E:\\HBuilderX\\save\\save\\pc_bg_f\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500371},{"path":"E:\\HBuilderX\\save\\save\\pc_bg_f\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500371},{"path":"E:\\HBuilderX\\save\\save\\pc_bg_f\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500371},{"path":"E:\\HBuilderX\\save\\save\\pc_bg_f\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500371}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouQ2hhdHsKCXdpZHRoOiAxMDAlOwoJLlBhbmVsewoJCS8vYmFja2dyb3VuZC1jb2xvcjogYmx1ZTsKCQloZWlnaHQ6NTgwcHg7CgkJd2lkdGg6NzAlOwoJCW1hcmdpbi10b3A6IDMwcHg7CgkJbWFyZ2luLWxlZnQ6IDEwJTsKCQltYXJnaW4tcmlnaHQ6IDEwMHB4OwoJCS5NeWNhcmR7CgkJCWhlaWdodDogMTAwJTsKCQkJL2RlZXAvIC5lbC1jYXJkX19oZWFkZXJ7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiNmNmY2ZjYgOwoJCQl9CgkJCS5oZWFkewoJCQkJLy9iYWNrZ3JvdW5kLWNvbG9yOiAjZjZmNmY2OwoJCQl9CgkJCS5ib2R5ewoJCQkJCgkJCQkubWlkZGxlewoJCQkJCXBhZGRpbmctbGVmdDogNXB4OwoJCQkJCXBhZGRpbmctcmlnaHQ6IDVweDsKCQkJCQloZWlnaHQ6IDQwNXB4OwoJCQkJCW92ZXJmbG93OiBhdXRvOwoJCQkJCS8vYmFja2dyb3VuZC1jb2xvcjogI2VhZWFlYTsKCQkJCQkubGVmdHsKCQkJCQkJcGFkZGluZy10b3A6IDVweDsKCQkJCQkJZmxvYXQ6bGVmdDsKCQkJCQkJdGV4dC1hbGlnbjogbGVmdDsKCQkJCQkJLmNoYXJ0Qm94ewoJCQkJCQkJcGFkZGluZy1sZWZ0OiAxNXB4OwoJCQkJCQl9CgkJCQkJCQoJCQkJCX0KCQkJCQkucmlnaHR7CgkJCQkJCWZsb2F0OnJpZ2h0OwoJCQkJCQl0ZXh0LWFsaWduOiByaWdodDsKCQkJCQkJLmNoYXJ0Qm94ewoJCQkJCQkJcGFkZGluZy1yaWdodDogMTVweDsKCQkJCQkJCXNwYW57CgkJCQkJCQkJcGFkZGluZzo1cHg7CgkJCQkJCQkJLy9iYWNrZ3JvdW5kLWNvbG9yOiAjZTJmNWZhOwoJCQkJCQkJCQoJCQkJCQkJfQoJCQkJCQkJCgkJCQkJCX0KCQkJCQl9CgkJCQkJLm5hbWV7CgkJCQkJCWZvbnQtc2l6ZTogMTJweDsKCQkJCQl9CgkJCQkJLmNoYXJ0Qm94ewoJCQkJCQlwYWRkaW5nOiA2cHg7CgkJCQkJCWZvbnQtc2l6ZTogMTZweDsKCQkJCQkJc3BhbnsKCQkJCQkJCWJhY2tncm91bmQtY29sb3I6ICNlMmY1ZmE7CgkJCQkJCQlib3JkZXI6IDFweCBzb2xpZCAjZTVlOGYwOwoJCQkJCQkJcGFkZGluZzogM3B4OwoJCQkJCQkJYm9yZGVyLXJhZGl1czogNXB4OwoJCQkJCQkJcGFkZGluZzo1cHg7CgkJCQkJCQl3b3JkLWJyZWFrOmJyZWFrLWFsbDsKCQkJCQkJCWRpc3BsYXk6aW5saW5lLWJsb2NrOwoJCQkJCQkJLy9kaXNwbGF5OmJsb2NrOyAKCQkJCQkJCS8vd29yZC13cmFwIDogYnJlYWstd29yZCA7CgkJCQkJCX0KCQkJCQkJCgkJCQkJfQoJCQkJfQoJCQkJLmJvdHRvbXsKCQkJCQloZWlnaHQ6IDkwcHg7CgkJCQkJLy9iYWNrZ3JvdW5kLWNvbG9yOiAjZTVlOGYwOwoJCQkJCWJvcmRlci10b3A6MXB4IHNvbGlkICNlNWU4ZjA7CgkJCQkJL2RlZXAvIC5lbC1idXR0b257CgkJCQkJCWJhY2tncm91bmQtY29sb3I6ICNlMmY1ZmE7CgkJCQkJCWJvcmRlci1jb2xvcjogICNjNmY1ZmE7CgkJCQkJCWNvbG9yOiBibGFjazsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJL2RlZXAvLmVsLWNhcmRfX2JvZHl7CgkJCQlwYWRkaW5nOiAwcHggIWltcG9ydGFudDsKCQkJCQoJCQl9CgkJCQoJCX0KCX0KfQoK"},{"version":3,"sources":["Chat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA","file":"Chat.vue","sourceRoot":"src/views/Home/Chat","sourcesContent":["<template>\n\t<div class=\"Chat\">\n\t\t<div class=\"Panel\">\n\t\t\t<el-card class=\"Mycard\">\n\t\t\t  <div class=\"head\" slot=\"header\" style=\"text-align: center;\">\n\t\t\t    <span >聊天框</span>\n\t\t\t  </div>\n\t\t\t  <div class=\"body\">\n\t\t\t\t<div ref=\"main\" class=\"middle\">\n\t\t\t\t\t<div ref=\"content\">\n\t\t\t\t\t\t<div v-for=\"item in Selectmessages\">\n\t\t\t\t\t\t\t<div :class=\"{left:item.customerId>0,right:item.customerId<0}\" style=\"width: 60%;\">\n\t\t\t\t\t\t\t\t<div class=\"name\">\n\t\t\t\t\t\t\t\t\t<span>{{name(item)}}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"chartBox\">\n\t\t\t\t\t\t\t\t  <span v-text=\"item.message\"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bottom\">\n\t\t\t\t\t<el-row>\n\t\t\t\t\t\t<el-col :span=\"8\">\n\t\t\t\t\t\t\t<span style=\"padding-left:4%; font-size: 10px;\">发送至：</span>\n\t\t\t\t\t\t\t<el-select v-model=\"value\"\n\t\t\t\t\t\t\t\t\t   size=\"mini\"\n\t\t\t\t\t\t\t\t\t   style=\"padding-left: 3%;padding-top: 3px;width:60%\" \n\t\t\t\t\t\t\t\t\t   placeholder=\"客户名\"\n\t\t\t\t\t\t\t\t\t   @change=\"refresh\">\n\t\t\t\t\t\t\t\t<el-option\n\t\t\t\t\t\t\t\t  v-for=\"item in baseCustomers\"\n\t\t\t\t\t\t\t\t  :value=\"item.index\"\n\t\t\t\t\t\t\t\t  :label=\"item.name\">\n\t\t\t\t\t\t\t\t</el-option>\n\t\t\t\t\t\t\t</el-select>\n\t\t\t\t\t\t</el-col>\n\t\t\t\t\t</el-row>\n\t\t\t\t\t<el-row>\n\t\t\t\t\t\t<el-col :span=\"20\">\n\t\t\t\t\t\t\t<el-input\n\t\t\t\t\t\t\t  style=\"padding-left: 2%;padding-top: 5px;\"\n\t\t\t\t\t\t\t  type=\"textarea\"\n\t\t\t\t\t\t\t  :autosize=\"{minRows:2,maxRows:3}\"\n\t\t\t\t\t\t\t  placeholder=\"请输入内容\"\n\t\t\t\t\t\t\t  v-model=\"message\">\n\t\t\t\t\t\t\t</el-input>\n\t\t\t\t\t\t</el-col>\n\t\t\t\t\t\t<el-col :span=\"4\">\n\t\t\t\t\t\t\t <el-button @click=\"sendMessage\" style=\" float:right; margin-right:15px;margin-top: 15px;\" type=\"warning\" size=\"small\">发送</el-button>\n\t\t\t\t\t\t</el-col>\n\t\t\t\t\t</el-row>\n\t\t\t\t</div>\n\t\t\t  </div>\n\t\t\t  \n\t\t\t</el-card>\n\t\t</div>\n\t</div>\n\t\n</template>\n\n<script>\n\texport default {\n\t\tdata(){\n\t\t\treturn{\n\t\t\t\t//如果id>0,则将customerName显示在左侧，为用户所发消息\n\t\t\t\t//如果id=-1,则将customerName显示在右侧，为管理员所回复的消息\n\t\t\t\tmessages:[],\n\t\t\t\tSelectmessages:[],\n\t\t\t\tbaseCustomers:[],\n\t\t\t\tvalue:'',\n\t\t\t\tmessage:'',\n\t\t\t\tws:''\n\t\t\t}\n\t\t\t\n\t\t},\n\t\tcomputed:{\n\t\t\t\n\t\t\tname(){\n\t\t\t\treturn(item)=>{\n\t\t\t\t\tif(item.customerId>0)return item.customerName;\n\t\t\t\t\telse return '回复:'+item.customerName;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\tsendMessage(){\n\t\t\t\tlet customerName='';\n\t\t\t\tfor(let i=0;i<this.baseCustomers.length;i++){\n\t\t\t\t\tif(this.value==this.baseCustomers[i].index){\n\t\t\t\t\t\tcustomerName=this.baseCustomers[i].name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlet message_item={customerId:-1,customerName:'',toId:0,message:''};\n\t\t\t\tmessage_item.customerName=customerName;\n\t\t\t\tmessage_item.message=this.message;\n\t\t\t\tmessage_item.toId=this.value;\n\t\t\t\tthis.messages.push(message_item);\n\t\t\t\tthis.Selectmessages.push(message_item);\n\t\t\t\t\n\t\t\t\tlet msg={from:0,to:0,message:''};\n\t\t\t\tmsg.from=-1;\n\t\t\t\tmsg.to=this.value;\n\t\t\t\tmsg.message=message_item.message;\n\t\t\t\tlet res=msg.message+'_'+msg.from+'_'+msg.to;\n\t\t\t\tconsole.log(res);\n\t\t\t\tthis.ws.send(res);\n\t\t\t\tthis.message='';\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t       this.$refs.main.scrollTop = this.$refs.content.scrollHeight;\n\t\t\t\t});\n\t\t\t},\n\t\t\twsMessage(event) {\n                console.log(event.data);//返回数据的内容\n\t\t\t\tlet data=JSON.parse(event.data);\n\t\t\t\tconsole.log(data.messageType);\n                if(data.messageType==1){\n\t\t\t\t\tlet message_item={customerId:-1,customerName:'',toId:-1,message:''};\n\t\t\t\t\tmessage_item.customerId=data.clientId;\n\t\t\t\t\tmessage_item.customerName=data.clientName;\n\t\t\t\t\tmessage_item.message=data.message;\n\t\t\t\t\tthis.messages.push(message_item);\r\n\t\t\t\t\tthis.refresh(data.clientId);\n\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t       this.$refs.main.scrollTop = this.$refs.content.scrollHeight;\n\t\t\t\t\t});\n\t\t\t\t}else if(data.messageType==2){\n\t\t\t\t\tthis.baseCustomers=[];\n\t\t\t\t\tlet list=data.onlineUsers;\n\t\t\t\t\tfor(let i=0;i<list.length;i++){\n\t\t\t\t\t\tif(list[i].customerId>0){\n\t\t\t\t\t\t\tlet item={name:'',index:''};\n\t\t\t\t\t\t\titem.name = list[i].customerName+'('+list[i].customerId+')';\n\t\t\t\t\t\t\titem.index = list[i].customerId;\n\t\t\t\t\t\t\tconsole.log(item);\n\t\t\t\t\t\t\tthis.baseCustomers.push(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\n            },\n            wsOpen() {\n                console.log('websocket-连接已经建立');\n            },\n            wsClose() {\n                console.log('websocket-连接已经关闭');\n            },\n            wsError() {\n                console.log('websocket-出现错误');\n            },\n\t\t\trefresh(val){\n\t\t\t\tthis.Selectmessages=[];\n\t\t\t\tfor(let i=0;i<this.messages.length;i++){\n\t\t\t\t\tif(this.messages[i].customerId==val||this.messages[i].toId==val){\n\t\t\t\t\t\tthis.Selectmessages.push(this.messages[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n            \n\t\t},\n\t\tcreated(){\n\t\t\tthis.ws = new WebSocket(`ws://localhost:8080/wss/客服小饱/-1`);\n\t\t\tthis.ws.onopen = this.wsOpen;\n\t\t\tthis.ws.onclose = this.wsClose;\n\t\t\tthis.ws.onerror = this.wsError;\n\t\t\tthis.ws.onmessage = this.wsMessage;\n\t\t}\n\t}\n</script>\n\n<style lang=\"less\" scoped>\n\n\t.Chat{\n\t\twidth: 100%;\n\t\t.Panel{\n\t\t\t//background-color: blue;\n\t\t\theight:580px;\n\t\t\twidth:70%;\n\t\t\tmargin-top: 30px;\n\t\t\tmargin-left: 10%;\n\t\t\tmargin-right: 100px;\n\t\t\t.Mycard{\n\t\t\t\theight: 100%;\n\t\t\t\t/deep/ .el-card__header{\n\t\t\t\t\tbackground-color:#f6f6f6 ;\n\t\t\t\t}\n\t\t\t\t.head{\n\t\t\t\t\t//background-color: #f6f6f6;\n\t\t\t\t}\n\t\t\t\t.body{\n\t\t\t\t\t\n\t\t\t\t\t.middle{\n\t\t\t\t\t\tpadding-left: 5px;\n\t\t\t\t\t\tpadding-right: 5px;\n\t\t\t\t\t\theight: 405px;\n\t\t\t\t\t\toverflow: auto;\n\t\t\t\t\t\t//background-color: #eaeaea;\n\t\t\t\t\t\t.left{\n\t\t\t\t\t\t\tpadding-top: 5px;\n\t\t\t\t\t\t\tfloat:left;\n\t\t\t\t\t\t\ttext-align: left;\n\t\t\t\t\t\t\t.chartBox{\n\t\t\t\t\t\t\t\tpadding-left: 15px;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.right{\n\t\t\t\t\t\t\tfloat:right;\n\t\t\t\t\t\t\ttext-align: right;\n\t\t\t\t\t\t\t.chartBox{\n\t\t\t\t\t\t\t\tpadding-right: 15px;\n\t\t\t\t\t\t\t\tspan{\n\t\t\t\t\t\t\t\t\tpadding:5px;\n\t\t\t\t\t\t\t\t\t//background-color: #e2f5fa;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.name{\n\t\t\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.chartBox{\n\t\t\t\t\t\t\tpadding: 6px;\n\t\t\t\t\t\t\tfont-size: 16px;\n\t\t\t\t\t\t\tspan{\n\t\t\t\t\t\t\t\tbackground-color: #e2f5fa;\n\t\t\t\t\t\t\t\tborder: 1px solid #e5e8f0;\n\t\t\t\t\t\t\t\tpadding: 3px;\n\t\t\t\t\t\t\t\tborder-radius: 5px;\n\t\t\t\t\t\t\t\tpadding:5px;\n\t\t\t\t\t\t\t\tword-break:break-all;\n\t\t\t\t\t\t\t\tdisplay:inline-block;\n\t\t\t\t\t\t\t\t//display:block; \n\t\t\t\t\t\t\t\t//word-wrap : break-word ;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t.bottom{\n\t\t\t\t\t\theight: 90px;\n\t\t\t\t\t\t//background-color: #e5e8f0;\n\t\t\t\t\t\tborder-top:1px solid #e5e8f0;\n\t\t\t\t\t\t/deep/ .el-button{\n\t\t\t\t\t\t\tbackground-color: #e2f5fa;\n\t\t\t\t\t\t\tborder-color:  #c6f5fa;\n\t\t\t\t\t\t\tcolor: black;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/deep/.el-card__body{\n\t\t\t\t\tpadding: 0px !important;\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\t\n</style>"]}]}